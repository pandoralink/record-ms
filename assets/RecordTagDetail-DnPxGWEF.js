import{c as _,g as se,r as u,R as m,j as d,u as Oe,a as we}from"./index-By7UgRYt.js";import{m as z,c as M,w as K}from"./with-default-props-CBsXvwG_.js";import{C as le,S as U,B as A,T as $e}from"./tag-D0MbBOvs.js";import{N as G}from"./nav-bar-A3hYDKde.js";import{S as B}from"./safe-area-BzdNV_Ox.js";import{c as Te,d as Le,e as Ne,a as Re,b as Pe}from"./context-Bd8U8-Yf.js";import{d as Me,b as _e,c as Ie,e as ie,f as De,a as Fe,g as ce,C as Ae,s as We,S as Be,h as Ve,i as ze,j as Ke,k as He,M as Ue,D as Ge}from"./hooks-DwCvS2xN.js";import{u as ue,a as D,w as Ze,S as qe,r as Xe,b as V,I as Ye}from"./input-DurSP33n.js";import{u as Z,a as Je}from"./use-props-value-CYLTqXE_.js";import{u as fe,a as Qe,S as et,E as tt,D as nt}from"./swipe-action-kgLlgV8Z.js";import{_ as rt,a as de,u as ot}from"./index-BvdF-Vz4.js";import{C as q,U as X}from"./UnorderedListOutline-Bt8V5tlk.js";import"./validate-Bt6ATdnj.js";function at(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var me=at,st=typeof _=="object"&&_&&_.Object===Object&&_,lt=st,it=lt,ct=typeof self=="object"&&self&&self.Object===Object&&self,ut=it||ct||Function("return this")(),ve=ut,ft=ve,dt=function(){return ft.Date.now()},mt=dt,vt=/\s/;function gt(t){for(var e=t.length;e--&&vt.test(t.charAt(e)););return e}var pt=gt,bt=pt,ht=/^\s+/;function yt(t){return t&&t.slice(0,bt(t)+1).replace(ht,"")}var Ct=yt,St=ve,xt=St.Symbol,ge=xt,Y=ge,pe=Object.prototype,jt=pe.hasOwnProperty,kt=pe.toString,P=Y?Y.toStringTag:void 0;function Et(t){var e=jt.call(t,P),n=t[P];try{t[P]=void 0;var o=!0}catch{}var r=kt.call(t);return o&&(e?t[P]=n:delete t[P]),r}var Ot=Et,wt=Object.prototype,$t=wt.toString;function Tt(t){return $t.call(t)}var Lt=Tt,J=ge,Nt=Ot,Rt=Lt,Pt="[object Null]",Mt="[object Undefined]",Q=J?J.toStringTag:void 0;function _t(t){return t==null?t===void 0?Mt:Pt:Q&&Q in Object(t)?Nt(t):Rt(t)}var It=_t;function Dt(t){return t!=null&&typeof t=="object"}var Ft=Dt,At=It,Wt=Ft,Bt="[object Symbol]";function Vt(t){return typeof t=="symbol"||Wt(t)&&At(t)==Bt}var zt=Vt,Kt=Ct,ee=me,Ht=zt,te=NaN,Ut=/^[-+]0x[0-9a-f]+$/i,Gt=/^0b[01]+$/i,Zt=/^0o[0-7]+$/i,qt=parseInt;function Xt(t){if(typeof t=="number")return t;if(Ht(t))return te;if(ee(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ee(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Kt(t);var n=Gt.test(t);return n||Zt.test(t)?qt(t.slice(2),n?2:8):Ut.test(t)?te:+t}var Yt=Xt,Jt=me,W=mt,ne=Yt,Qt="Expected a function",en=Math.max,tn=Math.min;function nn(t,e,n){var o,r,c,s,a,l,S=0,g=!1,b=!1,v=!0;if(typeof t!="function")throw new TypeError(Qt);e=ne(e)||0,Jt(n)&&(g=!!n.leading,b="maxWait"in n,c=b?en(ne(n.maxWait)||0,e):c,v="trailing"in n?!!n.trailing:v);function j(h){var k=o,E=r;return o=r=void 0,S=h,s=t.apply(E,k),s}function w(h){return S=h,a=setTimeout(i,e),g?j(h):s}function O(h){var k=h-l,E=h-S,L=e-k;return b?tn(L,c-E):L}function y(h){var k=h-l,E=h-S;return l===void 0||k>=e||k<0||b&&E>=c}function i(){var h=W();if(y(h))return p(h);a=setTimeout(i,O(h))}function p(h){return a=void 0,v&&o?j(h):(o=r=void 0,s)}function f(){a!==void 0&&clearTimeout(a),S=0,o=l=r=a=void 0}function C(){return a===void 0?s:p(W())}function x(){var h=W(),k=y(h);if(o=arguments,r=this,l=h,k){if(a===void 0)return w(l);if(b)return clearTimeout(a),a=setTimeout(i,e),j(l)}return a===void 0&&(a=setTimeout(i,e)),s}return x.cancel=f,x.flush=C,x}var rn=nn;const on=se(rn);function an(){var t=(typeof global>"u"?"undefined":typeof global)=="object"&&global&&global.Object===Object&&global,e=typeof self=="object"&&self&&self.Object===Object&&self;return t||e}an()||(global.Date=Date);function sn(t,e){var n,o=Te(t),r=(n=e==null?void 0:e.wait)!==null&&n!==void 0?n:1e3,c=u.useMemo(function(){return on(function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return o.current.apply(o,rt([],de(s),!1))},r,e)},[]);return Le(function(){c.cancel()}),{run:c,cancel:c.cancel,flush:c.flush}}function ln(t,e,n){var o=de(u.useState({}),2),r=o[0],c=o[1],s=sn(function(){c({})},n).run;u.useEffect(function(){return s()},e),Ne(t,[r])}var cn=typeof Element<"u",un=typeof Map=="function",fn=typeof Set=="function",dn=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function F(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,o,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(o=n;o--!==0;)if(!F(t[o],e[o]))return!1;return!0}var c;if(un&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(c=t.entries();!(o=c.next()).done;)if(!e.has(o.value[0]))return!1;for(c=t.entries();!(o=c.next()).done;)if(!F(o.value[1],e.get(o.value[0])))return!1;return!0}if(fn&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(c=t.entries();!(o=c.next()).done;)if(!e.has(o.value[0]))return!1;return!0}if(dn&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(o=n;o--!==0;)if(t[o]!==e[o])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[o]))return!1;if(cn&&t instanceof Element)return!1;for(o=n;o--!==0;)if(!((r[o]==="_owner"||r[o]==="__v"||r[o]==="__o")&&t.$$typeof)&&!F(t[r[o]],e[r[o]]))return!1;return!0}return t!==t&&e!==e}var mn=function(e,n){try{return F(e,n)}catch(o){if((o.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw o}};const vn=se(mn);function gn(t){return u.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},t,{style:Object.assign({verticalAlign:"-0.125em"},t.style),className:["antd-mobile-icon",t.className].filter(Boolean).join(" ")}),u.createElement("g",{id:"DownOutline-DownOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},u.createElement("g",null,u.createElement("rect",{id:"DownOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),u.createElement("path",{d:"M5.11219264,16.3947957 L22.6612572,34.5767382 L22.6612572,34.5767382 C23.2125856,35.1304785 24.0863155,35.1630514 24.6755735,34.6744571 L24.7825775,34.5767382 L42.8834676,16.3956061 C42.9580998,16.320643 43,16.2191697 43,16.1133896 L43,12.9866673 C43,12.7657534 42.8209139,12.5866673 42.6,12.5866673 C42.4936115,12.5866673 42.391606,12.6290496 42.316542,12.7044413 L23.7816937,31.3201933 L23.7816937,31.3201933 L5.6866816,12.7237117 C5.53262122,12.5653818 5.27937888,12.5619207 5.121049,12.7159811 C5.04365775,12.7912854 5,12.8946805 5,13.0026627 L5,16.1170064 C5,16.2206403 5.04022164,16.3202292 5.11219264,16.3947957 Z",id:"DownOutline-down",fill:"currentColor",fillRule:"nonzero"}))))}function pn(t){return u.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},t,{style:Object.assign({verticalAlign:"-0.125em"},t.style),className:["antd-mobile-icon",t.className].filter(Boolean).join(" ")}),u.createElement("g",{id:"FillinOutline-FillinOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},u.createElement("g",null,u.createElement("rect",{id:"FillinOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),u.createElement("path",{d:"M25,4.4 L25,6.6 C25,6.8209139 24.8209139,7 24.6,7 L10,7 L10,7 C8.40231912,7 7.09633912,8.24891996 7.00509269,9.82372721 L7,10 L7,38 C7,39.5976809 8.24891996,40.9036609 9.82372721,40.9949073 L10,41 L38,41 C39.5976809,41 40.9036609,39.75108 40.9949073,38.1762728 L41,38 L41,23.4 C41,23.1790861 41.1790861,23 41.4,23 L43.6,23 C43.8209139,23 44,23.1790861 44,23.4 L44,38 L44,38 C44,41.3137085 41.3137085,44 38,44 L10,44 C6.6862915,44 4,41.3137085 4,38 L4,10 C4,6.6862915 6.6862915,4 10,4 L24.6,4 C24.8209139,4 25,4.1790861 25,4.4 Z M41.9601551,5.53984489 C43.9127766,7.49246635 43.9127766,10.6582912 41.9601551,12.6109127 L28.6118774,25.9591904 C28.5300903,26.0409775 28.4169042,26.0833578 28.3015138,26.0753998 L22.2158336,25.6556977 C22.0166108,25.6419582 21.8580418,25.4833892 21.8443023,25.2841664 L21.4246002,19.1984862 C21.4166422,19.0830958 21.4590225,18.9699097 21.5408096,18.8881226 L34.8890873,5.53984489 L34.8890873,5.53984489 C36.8417088,3.58722343 40.0075336,3.58722343 41.9601551,5.53984489 Z M33.7750741,10.8963788 L24.6278496,20.0434238 C24.5460625,20.1252092 24.5036812,20.2383934 24.5116369,20.3537828 L24.6815479,22.8181501 L24.6815479,22.8181501 L27.1466809,22.9874098 C27.2620365,22.9953303 27.3751761,22.9529456 27.4569339,22.8711819 L36.6030741,13.7243788 L36.6030741,13.7243788 L33.7750741,10.8963788 Z M37.1198311,7.55949982 L37.0104076,7.66116524 L35.8960741,8.7743788 L38.7250741,11.6033788 L39.8388348,10.4895924 C40.5843811,9.74404598 40.6182696,8.55633208 39.9405002,7.77058865 L39.8388348,7.66116524 C39.0932884,6.91561886 37.9055745,6.88173039 37.1198311,7.55949982 Z",id:"FillinOutline-形状",fill:"currentColor",fillRule:"nonzero"}))))}const I="adm-popup",bn=Object.assign(Object.assign({},Me),{closeOnSwipe:!1,position:"bottom"}),hn=t=>{const e=z(bn,t),n=M(`${I}-body`,e.bodyClassName,`${I}-body-position-${e.position}`),{locale:o}=ue(),[r,c]=u.useState(e.visible),s=u.useRef(null);_e(s,e.disableBodyScroll&&r?"strict":!1),D(()=>{e.visible&&c(!0)},[e.visible]);const a=Ie(),{percent:l}=ie({percent:e.visible?0:100,config:{precision:.1,mass:.4,tension:300,friction:30},onRest:()=>{var v,j;a.current||(c(e.visible),e.visible?(v=e.afterShow)===null||v===void 0||v.call(e):(j=e.afterClose)===null||j===void 0||j.call(e))}}),S=fe(({swipe:[,v]})=>{var j;e.closeOnSwipe&&(v===1&&e.position==="bottom"||v===-1&&e.position==="top")&&((j=e.onClose)===null||j===void 0||j.call(e))},{axis:"y",enabled:["top","bottom"].includes(e.position)}),g=De(r&&e.visible),b=Ze(e.stopPropagation,K(e,m.createElement("div",Object.assign({className:I,onClick:e.onClick,style:{display:r?void 0:"none",touchAction:["top","bottom"].includes(e.position)?"none":"auto"}},S()),e.mask&&m.createElement(Fe,{visible:g,forceRender:e.forceRender,destroyOnClose:e.destroyOnClose,onMaskClick:v=>{var j,w;(j=e.onMaskClick)===null||j===void 0||j.call(e,v),e.closeOnMaskClick&&((w=e.onClose)===null||w===void 0||w.call(e))},className:e.maskClassName,style:e.maskStyle,disableBodyScroll:!1,stopPropagation:e.stopPropagation}),m.createElement(ce.div,{className:n,style:Object.assign(Object.assign({},e.bodyStyle),{pointerEvents:l.to(v=>v===0?"unset":"none"),transform:l.to(v=>e.position==="bottom"?`translate(0, ${v}%)`:e.position==="top"?`translate(0, -${v}%)`:e.position==="left"?`translate(-${v}%, 0)`:e.position==="right"?`translate(${v}%, 0)`:"none")}),ref:s},e.showCloseButton&&m.createElement("a",{className:M(`${I}-close-icon`,"adm-plain-anchor"),onClick:()=>{var v;(v=e.onClose)===null||v===void 0||v.call(e)},role:"button","aria-label":o.common.close},m.createElement(Ae,null)),e.children))));return m.createElement(qe,{active:r,forceRender:e.forceRender,destroyOnClose:e.destroyOnClose},Xe(e.getContainer,b))};function re(t,e,n){return t*e*n/(e+n*t)}function oe(t,e,n,o,r=.15){return r===0?V(t,e,n):t<e?-re(e-t,o,r)+e:t>n?+re(t-n,o,r)+n:t}function yn(t){if(t==null||t==="")return 0;const e=t.trim();return e.endsWith("px")?parseFloat(e):e.endsWith("rem")?parseFloat(e)*parseFloat(window.getComputedStyle(document.documentElement).fontSize):e.endsWith("vw")?parseFloat(e)*window.innerWidth/100:0}const $="adm-picker-view",be=u.memo(t=>{const{value:e,column:n,renderLabel:o}=t;function r(i){t.onSelect(i,t.index)}const[{y:c},s]=ie(()=>({from:{y:0},config:{tension:400,mass:.8}})),a=u.useRef(!1),l=u.useRef(null),S=u.useRef(null),g=u.useRef(34);D(()=>{const i=S.current;i&&(g.current=yn(window.getComputedStyle(i).getPropertyValue("height")))}),D(()=>{if(a.current||e===null)return;const i=n.findIndex(f=>f.value===e);if(i<0)return;const p=i*-g.current;s.start({y:p,immediate:c.goal!==p})},[e,n]),D(()=>{if(n.length===0)e!==null&&r(null);else if(!n.some(i=>i.value===e)){const i=n[0];r(i.value)}},[n,e]);function b(i){const p=i*-g.current;s.start({y:p});const f=n[i];f&&r(f.value)}const v=i=>{const{direction:[,p],distance:[,f],velocity:[,C],offset:[,x],last:h}=i;return{direction:p,distance:f,velocity:C,offset:x,last:h}},j=i=>{a.current=!0;const p=-((n.length-1)*g.current),f=0,{direction:C,last:x,velocity:h,offset:k}=v(i);if(x){a.current=!1;const E=k+h*C*50,L=V(E,p,f),R=-Math.round(L/g.current);b(R)}else{const E=k;s.start({y:oe(E,p,f,g.current*50,.2)})}},w=i=>{a.current=!0;const p=-((n.length-1)*g.current),f=0,{direction:C,last:x,velocity:h,distance:k}=v(i),E=-C,L=c.get();if(x){a.current=!1;const R=h*E*50,je=L+k*E+R,ke=V(je,p,f),Ee=-Math.round(ke/g.current);b(Ee)}else{const R=L+k*E;s.start({y:oe(R,p,f,g.current*50,.2)})}};fe(i=>{i.event.stopPropagation(),j(i)},{axis:"y",from:()=>[0,c.get()],filterTaps:!0,pointer:{touch:!0},target:l}),Qe(i=>{i.event.stopPropagation(),w(i)},{target:t.mouseWheel?l:void 0,axis:"y",from:()=>[0,c.get()],preventDefault:!0,eventOptions:We?{passive:!1}:void 0});let O=null;function y(){if(O===null)return null;const i=n[O],p=O-1,f=O+1,C=n[p],x=n[f];return m.createElement("div",{className:`${$}-column-accessible`},m.createElement("div",{className:`${$}-column-accessible-current`,role:"button","aria-label":i?`当前选择的是：${i.label}`:"当前未选择"},"-"),m.createElement("div",{className:`${$}-column-accessible-button`,onClick:()=>{C&&b(p)},role:C?"button":"text","aria-label":C?`选择上一项：${C.label}`:"没有上一项"},"-"),m.createElement("div",{className:`${$}-column-accessible-button`,onClick:()=>{x&&b(f)},role:x?"button":"text","aria-label":x?`选择下一项：${x.label}`:"没有下一项"},"-"))}return m.createElement("div",{className:`${$}-column`},m.createElement("div",{className:`${$}-item-height-measure`,ref:S}),m.createElement(ce.div,{ref:l,style:{translateY:c},className:`${$}-column-wheel`,"aria-hidden":!0},n.map((i,p)=>{var f;const C=t.value===i.value;C&&(O=p);function x(){a.current=!1,b(p)}return m.createElement("div",{key:(f=i.key)!==null&&f!==void 0?f:i.value,"data-selected":C,className:M(`${$}-column-item`,{[`${$}-column-item-active`]:C}),onClick:x,"aria-hidden":!C,"aria-label":C?"active":""},m.createElement("div",{className:`${$}-column-item-label`},o(i)))})),y())},(t,e)=>!(t.index!==e.index||t.value!==e.value||t.onSelect!==e.onSelect||t.renderLabel!==e.renderLabel||t.mouseWheel!==e.mouseWheel||!vn(t.column,e.column)));be.displayName="Wheel";function ae(t){let e=null;return()=>(e===null&&(e=t()),e)}function he(t,e){const n=ae(()=>(typeof t=="function"?t(e):t).map(s=>s.map(a=>typeof a=="string"?{label:a,value:a}:a))),o=ae(()=>e.map((c,s)=>{var a;const l=n()[s];return l&&(a=l.find(S=>S.value===c))!==null&&a!==void 0?a:null}));return{get columns(){return n()},get items(){return o()}}}function ye(t,e){return u.useMemo(()=>he(t,e),[t,e])}const Ce=t=>t.label,N="adm-picker-view",Cn={defaultValue:[],renderLabel:Ce,mouseWheel:!1,loadingContent:m.createElement("div",{className:`${N}-loading-content`},m.createElement(Be,null))},Se=u.memo(t=>{const e=z(Cn,t),[n,o]=u.useState(e.value===void 0?e.defaultValue:e.value);u.useEffect(()=>{e.value!==void 0&&e.value!==n&&o(e.value)},[e.value]),u.useEffect(()=>{if(e.value===n)return;const a=window.setTimeout(()=>{e.value!==void 0&&e.value!==n&&o(e.value)},1e3);return()=>{window.clearTimeout(a)}},[e.value,n]);const r=ye(e.columns,n),c=r.columns;ln(()=>{var a;e.value!==n&&((a=e.onChange)===null||a===void 0||a.call(e,n,r))},[n],{wait:0,leading:!1,trailing:!0});const s=u.useCallback((a,l)=>{o(S=>{const g=[...S];return g[l]=a,g})},[]);return K(e,m.createElement("div",{className:`${N}`},e.loading?e.loadingContent:m.createElement(m.Fragment,null,c.map((a,l)=>m.createElement(be,{key:l,index:l,column:a,value:n[l],onSelect:s,renderLabel:e.renderLabel,mouseWheel:e.mouseWheel})),m.createElement("div",{className:`${N}-mask`},m.createElement("div",{className:`${N}-mask-top`}),m.createElement("div",{className:`${N}-mask-middle`}),m.createElement("div",{className:`${N}-mask-bottom`})))))});Se.displayName="PickerView";const T="adm-picker",Sn={defaultValue:[],closeOnMaskClick:!0,renderLabel:Ce,destroyOnClose:!1,forceRender:!1},H=u.memo(u.forwardRef((t,e)=>{var n;const{locale:o}=ue(),r=z(Sn,{confirmText:o.common.confirm,cancelText:o.common.cancel},t),[c,s]=Z({value:r.visible,defaultValue:!1,onChange:y=>{var i;y===!1&&((i=r.onClose)===null||i===void 0||i.call(r))}}),a={toggle:()=>{s(y=>!y)},open:()=>{s(!0)},close:()=>{s(!1)}};u.useImperativeHandle(e,()=>a);const[l,S]=Z(Object.assign(Object.assign({},r),{onChange:y=>{var i;const p=he(r.columns,y);(i=r.onConfirm)===null||i===void 0||i.call(r,y,p)}})),g=ye(r.columns,l),[b,v]=u.useState(l);u.useEffect(()=>{b!==l&&v(l)},[c]),u.useEffect(()=>{c||v(l)},[l]);const j=ot((y,i)=>{var p;v(y),c&&((p=r.onSelect)===null||p===void 0||p.call(r,y,i))}),w=K(r,m.createElement("div",{className:T},m.createElement("div",{className:`${T}-header`},m.createElement("a",{role:"button",className:`${T}-header-button`,onClick:()=>{var y;(y=r.onCancel)===null||y===void 0||y.call(r),s(!1)}},r.cancelText),m.createElement("div",{className:`${T}-header-title`},r.title),m.createElement("a",{role:"button",className:M(`${T}-header-button`,r.loading&&`${T}-header-button-disabled`),onClick:()=>{r.loading||(S(b,!0),s(!1))},"aria-disabled":r.loading},r.confirmText)),m.createElement("div",{className:`${T}-body`},m.createElement(Se,{loading:r.loading,loadingContent:r.loadingContent,columns:r.columns,renderLabel:r.renderLabel,value:b,mouseWheel:r.mouseWheel,onChange:j})))),O=m.createElement(hn,{style:r.popupStyle,className:M(`${T}-popup`,r.popupClassName),visible:c,position:"bottom",onMaskClick:()=>{var y;r.closeOnMaskClick&&((y=r.onCancel)===null||y===void 0||y.call(r),s(!1))},getContainer:r.getContainer,destroyOnClose:r.destroyOnClose,afterShow:r.afterShow,afterClose:r.afterClose,onClick:r.onClick,forceRender:r.forceRender,stopPropagation:r.stopPropagation},w,m.createElement(B,{position:"bottom"}));return m.createElement(m.Fragment,null,O,(n=r.children)===null||n===void 0?void 0:n.call(r,g.items,a))}));H.displayName="Picker";function xn(t){return new Promise(e=>{const n=()=>{const[r,c]=u.useState(!1);return u.useEffect(()=>{c(!0)},[]),m.createElement(H,Object.assign({},t,{visible:r,onConfirm:(s,a)=>{var l;(l=t.onConfirm)===null||l===void 0||l.call(t,s,a),e(s)},onClose:()=>{var s;(s=t.onClose)===null||s===void 0||s.call(t),c(!1),e(null)},afterClose:()=>{var s;(s=t.afterClose)===null||s===void 0||s.call(t),o()}}))},o=Ve(m.createElement(n,null))})}const xe=Je(H,{prompt:xn}),jn=()=>{const t=Array.from({length:24},(n,o)=>({label:`${o}`.padStart(2,"0"),value:o})),e=Array.from({length:60},(n,o)=>({label:`${o}`.padStart(2,"0"),value:o}));return[t,e]};function kn({initialTimestamp:t,visible:e,onClose:n,onConfirm:o}){const[r]=u.useState(()=>t?new Date(t):new Date),[c,s]=u.useState([r.getHours(),r.getMinutes()]),a=u.useMemo(jn,[]);return d.jsx(xe,{columns:a,visible:e,onClose:()=>{n()},value:c,onConfirm:l=>{const[S,g]=l,b=new Date(r.getTime());b.setHours(Number(S)),b.setMinutes(Number(g)),s([b.getHours(),b.getMinutes()]),o==null||o(b.getTime())}})}function En(t,e){return e?e.find(n=>n.aKey===t)||{aKey:1,name:"j"}:{aKey:1,name:"j"}}const On=({recordKey:t,actionItem:e,time:n,desc:o})=>{const r=Re(),c=ze(),s=Ke(),a=He(),[l]=u.useState(En(e.aKey,r)),[S,g]=u.useState(!1),[b,v]=u.useState(!1),[j,w]=u.useState(""),O=u.useRef("");O.current=j;const y=u.useMemo(()=>{const f=new Date(n);return`${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")} ${String(f.getHours()).padStart(2,"0")}:${String(f.getMinutes()).padStart(2,"0")}`},[n]),i=u.useMemo(()=>[(r==null?void 0:r.map(f=>({label:f.name,value:f.aKey})))||[]],[r]),p=u.useMemo(()=>[l.aKey],[l.aKey]);return r?d.jsxs("div",{children:[d.jsx("div",{style:{backgroundColor:"#f2f2f7",padding:"16px"},children:d.jsx(et,{style:{borderRadius:8},rightActions:[{key:"rename",text:d.jsx(tt,{fontSize:36}),color:"warning",onClick:f=>{f.stopPropagation(),g(!0)}},{key:"delete",text:d.jsx(nt,{fontSize:36}),color:"danger",onClick:f=>{f.stopPropagation(),a({time:n,desc:o},e,t)}}],children:d.jsx(le,{title:e.name,bodyStyle:{textAlign:"left"},extra:d.jsxs(U,{children:[d.jsx(A,{fill:"none",onClick:f=>{f.stopPropagation(),v(!0)},children:d.jsx(gn,{})}),d.jsx(A,{fill:"none",onClick:f=>{f.stopPropagation(),Ue.show({content:d.jsxs("div",{children:[d.jsx(Ye,{placeholder:"请输入内容",defaultValue:o,onChange:w}),d.jsx(Ge,{style:{margin:0}})]}),closeOnAction:!0,closeOnMaskClick:!0,actions:[{key:"confirm-update-desc",text:"重命名",primary:!0,onClick:()=>{s({time:n,desc:O.current},e,t,n)}}]})},children:d.jsx(pn,{})})]}),children:d.jsxs(U,{direction:"vertical",children:[y,o?d.jsx("span",{children:o}):null]})})})}),d.jsx(xe,{columns:i,visible:S,onClose:()=>{g(!1)},defaultValue:p,onConfirm:f=>{const[C]=f,x=r.find(h=>h.aKey===Number(C));x&&c({time:n,desc:o},x,t),g(!1)}}),d.jsx(kn,{initialTimestamp:n,visible:b,onClose:()=>{v(!1)},onConfirm:f=>{const C=new Date(f),x=new Date(n);x.setHours(C.getHours()),x.setMinutes(C.getMinutes()),s({time:x.getTime(),desc:o},e,t,n),v(!1)}})]}):null};function wn(t){const e=new Date(t);let n=e.getHours();return e.getMinutes()>=30&&n++,`${n.toString().padStart(2,"0")}:30`}function $n(t){const e={};return t.record.forEach(n=>{const o=wn(n.time);e[o]||(e[o]=0),e[o]++}),e}function Tn({clickItem:t}){const e=$n(t);return d.jsx("div",{children:Object.entries(e).map(([n,o])=>d.jsx("div",{style:{backgroundColor:"#f2f2f7",padding:"16px"},children:d.jsx(le,{title:`${String(parseInt(n.split(":")[0],10)-1).padStart(2,"0")}:30-${n}`,bodyStyle:{textAlign:"left"},children:d.jsxs($e,{round:!0,color:"primary",style:{fontSize:18,fontWeight:"bold",minWidth:60,paddingTop:4,paddingBottom:4,textAlign:"center"},children:[t.actionItem.name," + ",o]})})},n))})}const zn=()=>{const t=Oe(),e=Pe(),[n]=we(),[o]=u.useState(n.get("recordKey")||""),[r]=u.useState(Number(n.get("clickItemKey")||"")),[c,s]=u.useState(!0),a=u.useMemo(()=>{var S;const l=(S=e==null?void 0:e.find(g=>g.rKey===o))==null?void 0:S.items.find(g=>g.rKey===r);return l&&l.record.sort((g,b)=>b.time-g.time),l},[r,o,e]);return a?c?d.jsxs(d.Fragment,{children:[d.jsx(B,{position:"top",style:{background:"#f2f2f7"}}),d.jsx(G,{style:{backgroundColor:"#f2f2f7"},onBack:()=>{t(-1)},right:d.jsx("div",{style:{paddingTop:8},children:d.jsx(A,{fill:"none",onClick:()=>{s(l=>!l)},children:c?d.jsx(q,{fontSize:24}):d.jsx(X,{fontSize:24})})})}),d.jsx(Tn,{clickItem:a})]}):d.jsxs("div",{children:[d.jsx(B,{position:"top",style:{background:"#f2f2f7"}}),d.jsx(G,{style:{backgroundColor:"#f2f2f7"},onBack:()=>{t(-1)},right:d.jsx("div",{children:d.jsx(A,{fill:"none",onClick:()=>{s(l=>!l)},children:c?d.jsx(q,{fontSize:24}):d.jsx(X,{fontSize:24})})})}),a.record.map(l=>d.jsx("div",{children:d.jsx(On,{time:l.time,desc:l.desc,actionItem:a.actionItem,recordKey:o})},l.time))]}):null};export{zn as RecordTagDetail};
