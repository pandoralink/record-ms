import{r as t,j as l,u as B}from"./index-BKYHviBL.js";import"./with-default-props-Cw5r2lmh.js";import{B as j}from"./button-C0scqWR1.js";import{C as H}from"./card-BPohsxVP.js";import{E as K,M as z,D as I}from"./index-ClQDLxvM.js";import{I as V}from"./input-M0AVySy-.js";import{P as y}from"./index-iYXtnasV.js";import{S as D}from"./space-CO4GaFR4.js";import{S as $,D as U}from"./swipe-action-BBjnjFZ1.js";import{u as M,b as Z}from"./index-wziMPack.js";import{c as _,b as W,a as X}from"./context-CvGcWdEt.js";import{b as q,c as G,d as J}from"./hooks-CDcXpyfB.js";function Q(e){return t.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),t.createElement("g",{id:"DownOutline-DownOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",null,t.createElement("rect",{id:"DownOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),t.createElement("path",{d:"M5.11219264,16.3947957 L22.6612572,34.5767382 L22.6612572,34.5767382 C23.2125856,35.1304785 24.0863155,35.1630514 24.6755735,34.6744571 L24.7825775,34.5767382 L42.8834676,16.3956061 C42.9580998,16.320643 43,16.2191697 43,16.1133896 L43,12.9866673 C43,12.7657534 42.8209139,12.5866673 42.6,12.5866673 C42.4936115,12.5866673 42.391606,12.6290496 42.316542,12.7044413 L23.7816937,31.3201933 L23.7816937,31.3201933 L5.6866816,12.7237117 C5.53262122,12.5653818 5.27937888,12.5619207 5.121049,12.7159811 C5.04365775,12.7912854 5,12.8946805 5,13.0026627 L5,16.1170064 C5,16.2206403 5.04022164,16.3202292 5.11219264,16.3947957 Z",id:"DownOutline-down",fill:"currentColor",fillRule:"nonzero"}))))}function Y(e){return t.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),t.createElement("g",{id:"FillinOutline-FillinOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",null,t.createElement("rect",{id:"FillinOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),t.createElement("path",{d:"M25,4.4 L25,6.6 C25,6.8209139 24.8209139,7 24.6,7 L10,7 L10,7 C8.40231912,7 7.09633912,8.24891996 7.00509269,9.82372721 L7,10 L7,38 C7,39.5976809 8.24891996,40.9036609 9.82372721,40.9949073 L10,41 L38,41 C39.5976809,41 40.9036609,39.75108 40.9949073,38.1762728 L41,38 L41,23.4 C41,23.1790861 41.1790861,23 41.4,23 L43.6,23 C43.8209139,23 44,23.1790861 44,23.4 L44,38 L44,38 C44,41.3137085 41.3137085,44 38,44 L10,44 C6.6862915,44 4,41.3137085 4,38 L4,10 C4,6.6862915 6.6862915,4 10,4 L24.6,4 C24.8209139,4 25,4.1790861 25,4.4 Z M41.9601551,5.53984489 C43.9127766,7.49246635 43.9127766,10.6582912 41.9601551,12.6109127 L28.6118774,25.9591904 C28.5300903,26.0409775 28.4169042,26.0833578 28.3015138,26.0753998 L22.2158336,25.6556977 C22.0166108,25.6419582 21.8580418,25.4833892 21.8443023,25.2841664 L21.4246002,19.1984862 C21.4166422,19.0830958 21.4590225,18.9699097 21.5408096,18.8881226 L34.8890873,5.53984489 L34.8890873,5.53984489 C36.8417088,3.58722343 40.0075336,3.58722343 41.9601551,5.53984489 Z M33.7750741,10.8963788 L24.6278496,20.0434238 C24.5460625,20.1252092 24.5036812,20.2383934 24.5116369,20.3537828 L24.6815479,22.8181501 L24.6815479,22.8181501 L27.1466809,22.9874098 C27.2620365,22.9953303 27.3751761,22.9529456 27.4569339,22.8711819 L36.6030741,13.7243788 L36.6030741,13.7243788 L33.7750741,10.8963788 Z M37.1198311,7.55949982 L37.0104076,7.66116524 L35.8960741,8.7743788 L38.7250741,11.6033788 L39.8388348,10.4895924 C40.5843811,9.74404598 40.6182696,8.55633208 39.9405002,7.77058865 L39.8388348,7.66116524 C39.0932884,6.91561886 37.9055745,6.88173039 37.1198311,7.55949982 Z",id:"FillinOutline-形状",fill:"currentColor",fillRule:"nonzero"}))))}function ee(e){return t.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),t.createElement("g",{id:"UpOutline-UpOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",null,t.createElement("rect",{id:"UpOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),t.createElement("path",{d:"M5.11219264,30.7053818 L22.6612572,12.5234393 L22.6612572,12.5234393 C23.2125856,11.969699 24.0863155,11.9371261 24.6755735,12.4257204 L24.7825775,12.5234393 L42.8834676,30.7045714 C42.9580998,30.7795345 43,30.8810078 43,30.9867879 L43,34.1135102 C43,34.3344241 42.8209139,34.5135102 42.6,34.5135102 C42.4936115,34.5135102 42.391606,34.4711279 42.316542,34.3957362 L23.7816937,15.7799842 L23.7816937,15.7799842 L5.6866816,34.3764658 C5.53262122,34.5347957 5.27937888,34.5382568 5.121049,34.3841964 C5.04365775,34.3088921 5,34.205497 5,34.0975148 L5,30.9831711 C5,30.8795372 5.04022164,30.7799483 5.11219264,30.7053818 Z",id:"UpOutline-up",fill:"currentColor",fillRule:"nonzero"}))))}const te=(e=!1)=>{const i=Array.from({length:24},(o,r)=>({label:`${r}`.padStart(2,"0"),value:r})),s=Array.from({length:60},(o,r)=>({label:`${r}`.padStart(2,"0"),value:r}));if(e){const o=Array.from({length:12},(m,c)=>({label:`${c+1}`.padStart(2,"0"),value:c+1})),r=Array.from({length:31},(m,c)=>({label:`${c+1}`.padStart(2,"0"),value:c+1}));return[o,r,i,s]}return[i,s]};function ne(e,i=!1){return i?[e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes()]:[e.getHours(),e.getMinutes()]}function le({initialTimestamp:e,visible:i,onClose:s,onConfirm:o}){const{showMode:r}=M(),[m]=t.useState(()=>e?new Date(e):new Date),[c,h]=t.useState(()=>ne(m,r)),C=t.useMemo(()=>te(r),[r]);return l.jsx(y,{columns:C,visible:i,onClose:()=>{s()},value:c,onConfirm:p=>{const[w,x]=p,a=new Date(m.getTime());if(r){const[L,g,v,f]=p;a.setMonth(Number(L)-1),a.setDate(Number(g)),a.setHours(Number(v)),a.setMinutes(Number(f)),h([a.getMonth()+1,a.getDate(),a.getHours(),a.getMinutes()]),o==null||o(a.getTime())}else a.setHours(Number(w)),a.setMinutes(Number(x)),h([a.getHours(),a.getMinutes()]),o==null||o(a.getTime())}})}const se=({name:e})=>{const{showMode:i}=M(),s=_(),o=t.useMemo(()=>{let r="";return!i||!s?r=e:r=s[e]||e,r},[s,e,i]);return l.jsx(l.Fragment,{children:o})};function ie(e,i){return i?i.find(s=>s.aKey===e)||{aKey:1,name:"j"}:{aKey:1,name:"j"}}const we=({recordKey:e,actionItem:i,time:s,desc:o})=>{const r=B(),m=W(),c=X(),h=q(),C=G(),p=J(),w=Z(),{showMode:x}=M(),[a]=t.useState(ie(i.aKey,c)),[L,g]=t.useState(!1),[v,f]=t.useState(!1),[S,O]=t.useState(""),b=t.useRef("");b.current=S;const[F,k]=t.useState(!1),R=t.useMemo(()=>{const n=new Date(s);return`${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")} ${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`},[s]),E=t.useMemo(()=>[(c==null?void 0:c.map(n=>({label:n.name,value:n.aKey})))||[]],[c]),A=t.useMemo(()=>[(m==null?void 0:m.map(n=>({label:n.rKey,value:n.rKey})))||[]],[m]),N=t.useMemo(()=>[a.aKey],[a.aKey]),P=t.useMemo(()=>[e],[e]);return c?l.jsxs("div",{children:[l.jsx("div",{style:{backgroundColor:"#f2f2f7",padding:"16px"},children:l.jsx($,{style:{borderRadius:8},rightActions:[{key:"rename",text:l.jsx(K,{fontSize:36}),color:"warning",onClick:n=>{n.stopPropagation(),g(!0)}},{key:"move-out",text:l.jsx(ee,{fontSize:36}),color:"primary",onClick:n=>{n.stopPropagation(),k(!0)}},{key:"delete",text:l.jsx(U,{fontSize:36}),color:"danger",onClick:n=>{n.stopPropagation(),p({time:s,desc:o},i,e,()=>{r(-1)})}}],children:l.jsx(H,{title:l.jsx(se,{name:i.name}),bodyStyle:{textAlign:"left"},extra:l.jsxs(D,{children:[l.jsx(j,{fill:"none",onClick:n=>{n.stopPropagation(),f(!0)},children:l.jsx(Q,{fontSize:24})}),l.jsx(j,{fill:"none",onClick:n=>{n.stopPropagation(),z.show({content:l.jsxs("div",{children:[l.jsx(V,{placeholder:"请输入描述",defaultValue:o,onChange:O}),l.jsx(I,{style:{margin:0}})]}),closeOnAction:!0,closeOnMaskClick:!0,actions:[{key:"confirm-update-desc",text:"更新描述",primary:!0,onClick:()=>{C({time:s,desc:b.current},i,e,s)}}]})},children:l.jsx(Y,{fontSize:24})})]}),children:l.jsxs(D,{direction:"vertical",children:[R,o?l.jsx("span",{children:o}):null]})})})}),l.jsx(y,{columns:E,visible:L,onClose:()=>{g(!1)},defaultValue:N,onConfirm:n=>{const[u]=n,d=c.find(T=>T.aKey===Number(u));d&&h({time:s,desc:o},d,i,e),g(!1),r(-1)}}),l.jsx(y,{columns:A,visible:F,onClose:()=>{k(!1)},defaultValue:P,onConfirm:n=>{const[u]=n;u&&w({time:s,desc:o},i,e,String(u)),k(!1),r(-1)}}),l.jsx(le,{initialTimestamp:s,visible:v,onClose:()=>{f(!1)},onConfirm:n=>{const u=new Date(n),d=new Date(s);x&&(d.setMonth(u.getMonth()),d.setDate(u.getDate())),d.setHours(u.getHours()),d.setMinutes(u.getMinutes()),C({time:d.getTime(),desc:o},i,e,s),f(!1)}})]}):null};export{we as R};
