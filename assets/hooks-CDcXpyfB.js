import{r as a}from"./index-BKYHviBL.js";import{k as y,m as C,l as K}from"./context-CvGcWdEt.js";import{u as I}from"./utils-CSvAkENd.js";function x(){const r=y();return a.useCallback(o=>{r(i=>{const f=[{rKey:o,items:[]}];return i?[...i,...f]:f})},[r])}function g(){const r=C(),o=y();return a.useCallback((i,f="")=>{o(c=>{const d=new Date().getTime(),s={time:new Date().getTime(),desc:f};if(!c)return[{rKey:r,items:[{rKey:d,actionItem:i,record:[s]}]}];const t=K.cloneDeep(c),n=t.find(e=>e.rKey===r);if(n){const e=n.items.find(u=>u.actionItem.aKey===i.aKey);e?e.record.push(s):n.items.push({rKey:d,actionItem:i,record:[s]})}else t.push({rKey:r,items:[{rKey:d,actionItem:i,record:[s]}]}),t.sort((e,u)=>e.rKey>u.rKey?-1:e.rKey<u.rKey?1:0);return t})},[r,o])}function k(){const r=y();return a.useCallback((o,i,f,c)=>{r(d=>{var l,p;const s=I(o,i,c,d),t=s.find(m=>m.rKey===c),n=(l=t==null?void 0:t.items)==null?void 0:l.find(m=>m.actionItem.aKey===f.aKey),e=n==null?void 0:n.record,u=e==null?void 0:e.findIndex(m=>m.time===o.time);return u!==void 0&&u!==-1&&(e==null||e.splice(u,1)),(n==null?void 0:n.record.length)===0&&((p=t==null?void 0:t.items)==null||p.splice(t==null?void 0:t.items.findIndex(m=>m.rKey===n.rKey),1)),s})},[r])}function A(){const r=y();return a.useCallback((o,i,f,c)=>{r(d=>{if(!d)return[];const s=K.cloneDeep(d),t=s==null?void 0:s.find(e=>e.rKey===f),n=t==null?void 0:t.items.find(e=>e.actionItem.aKey===i.aKey);if(!t)return s;if(n){const e=n.record.find(u=>u.time===c);e&&(e.time=o.time,e.desc=o.desc)}return s})},[r])}function T(){const r=y();return a.useCallback((o,i,f,c)=>{r(d=>{if(!d)return[];const s=K.cloneDeep(d),t=s==null?void 0:s.find(e=>e.rKey===f),n=t==null?void 0:t.items.find(e=>e.actionItem.aKey===i.aKey);return t&&n&&(n.record=n.record.filter(e=>e.time!==o.time),n.record.length===0&&(t.items=t.items.filter(e=>e.actionItem.aKey!==i.aKey),c==null||c())),s})},[r])}export{x as a,k as b,A as c,T as d,g as u};
