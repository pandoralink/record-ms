import{u as P,r as c,j as t}from"./index-C_UHGJlV.js";import{P as v}from"./PageWrapper-CamlHtV8.js";import"./with-default-props-BmUU8plZ.js";import{B as x}from"./button-KzJBAVMH.js";import{C as w}from"./card-baXAEpy5.js";import{L as i}from"./index-JVOmVxDD.js";import{S as D}from"./space-DZXRz-Pd.js";import{T}from"./text-area-DPoUfs7c.js";import{T as B}from"./index-Dw_mgCSK.js";import{b as E,k as K,l as V}from"./context-CHFXciok.js";import"./nav-bar-B6I3cWZY.js";import"./safe-area-CBXG4b09.js";import"./index-Bd-V8bsQ.js";import"./validate-BWrBp5BA.js";import"./attach-properties-to-component-CxYBDbn1.js";import"./index-CjZyqMMv.js";import"./index.esm-Cg_c7sd2.js";import"./use-props-value-Cy7HmYQB.js";import"./useInputHandleKeyDown-8zIOh0RG.js";import"./spin-loading-BErI0OSI.js";import"./react-spring-web.esm-B9-Uweta.js";import"./should-render-pC6EtMPP.js";import"./with-stop-propagation-DAJ1rTaH.js";import"./config-provider-CHdY5msv.js";import"./auto-center-Bm1bJHZc.js";const nt=()=>{const g=P(),n=E(),L=K(),[f,l]=c.useState(""),[j,m]=c.useState([]),[r,y]=c.useState(null),[p,d]=c.useState(!1);return t.jsx(v,{title:"导入数据",onBack:()=>{g(-1)},children:t.jsxs(D,{direction:"vertical",style:{backgroundColor:"#f2f2f7",padding:"16px",width:"100%",boxSizing:"border-box"},children:[t.jsx(w,{children:t.jsx(T,{placeholder:"请输入内容",rows:5,value:f,onChange:e=>{l(e)}})}),!p&&t.jsx(x,{block:!0,color:"primary",size:"large",onClick:()=>{try{const{recordList:e}=JSON.parse(f),o=V.cloneDeep(n),S=(o==null?void 0:o.length)||0,b=(n==null?void 0:n.length)||0,k=(o||[]).reduce((a,u)=>(a[u.rKey]=u.rKey,a),{}),s=e.filter(a=>!k[a.rKey]),C=(s==null?void 0:s.length)||0,h=[...o,...s],I=(h==null?void 0:h.length)||0;y({originalDataLength:S,parsedRecordListLength:b,combinedRecordListLength:C,resultLength:I}),m(s),d(!0)}catch(e){B.show({content:String(e)})}},children:"编译"}),p&&t.jsxs(i,{mode:"card",style:{textAlign:"left"},children:[t.jsx(i.Item,{extra:(r==null?void 0:r.originalDataLength)||0,children:"本地数据长度"}),t.jsx(i.Item,{extra:(r==null?void 0:r.parsedRecordListLength)||0,children:"解析后数据长度"}),t.jsx(i.Item,{extra:(r==null?void 0:r.combinedRecordListLength)||0,children:"解析后有效数据长度"}),t.jsx(i.Item,{extra:(r==null?void 0:r.resultLength)||0,children:"最终本地数据度"})]}),p&&t.jsxs("div",{style:{display:"flex",columnGap:16},children:[t.jsx(x,{style:{width:"50%"},onClick:()=>{m([]),l(""),d(!1)},children:"取消"}),t.jsx(x,{color:"primary",style:{width:"50%"},onClick:()=>{L(e=>e?[...e,...j]:[]),m([]),l(""),d(!1),g(-1)},children:"保存"})]})]})})};export{nt as ImportData};
